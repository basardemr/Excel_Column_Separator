private void btnExcelHazirla_Click(object sender, EventArgs e)
{
    string klasorAdi = Environment.GetFolderPath(Environment.SpecialFolder.Desktop) + "\\" + "Karsilastirmali";

    Excell.Application xlApp = new Excell.Application();
    Excell.Workbook xlWorkBook2 = xlApp.Workbooks.Add(Type.Missing);
    Excell.Worksheet xlWorkSheet2 = (Excell.Worksheet)xlWorkBook2.ActiveSheet;
    xlWorkSheet2.Name = "Olusturulan_" + DateTime.Now.Date.ToString("dd.MM.yyyy");

    xlApp.PrintCommunication = false;



    int a = 0;

    for (int i = 0; i < listSecili.Count; i++)
    {
        xlWorkSheet2.Cells[1, i + 1].Value2 = listSecili[i];
        xlWorkSheet2.Columns.AutoFit();


        xlWorkSheet2.Cells[1, i + 1].Font.Bold = true;

        Excell.Borders border = xlWorkSheet2.Cells[1, i + 1].Borders;
        BordersForArea(border);
    }


    switch (!Directory.Exists(klasorAdi))
    {
        case true:
            Directory.CreateDirectory(klasorAdi);

            foreach (Control item in this.Controls)
            {
                if (item.GetType() == typeof(System.Windows.Forms.CheckBox))
                {
                    if ((item as System.Windows.Forms.CheckBox).Name == "chck_Sipariş Saati" && (item as System.Windows.Forms.CheckBox).Checked == true)
                    {
                        a++;
                        for (int i = 0; i < bolunmusDeger.Count; i++)
                        {
                            xlWorkSheet2.Cells[i + 2, a].Value2 = bolunmusDeger[i].SiparisSaati;
                            xlWorkSheet2.Columns.AutoFit();

                            Excell.Borders border = xlWorkSheet2.Cells[i + 2, a].Borders;
                            BordersForArea(border);

                            tsPB.Increment(i);
                        }
                    }


                    if ((item as System.Windows.Forms.CheckBox).Name == "chck_Müşteri Adı" && (item as System.Windows.Forms.CheckBox).Checked == true)
                    {
                        a++;
                        for (int i = 0; i < bolunmusDeger.Count; i++)
                        {
                            xlWorkSheet2.Cells[i + 2, a].Value2 = bolunmusDeger[i].MusteriAdi;
                            xlWorkSheet2.Columns.AutoFit();

                            Excell.Borders border = xlWorkSheet2.Cells[i + 2, a].Borders;
                            BordersForArea(border);

                            tsPB.Increment(i);
                        }
                    }


                    if ((item as System.Windows.Forms.CheckBox).Name == "chck_Müşteri Soyadı" && (item as System.Windows.Forms.CheckBox).Checked == true)
                    {
                        a++;
                        for (int i = 0; i < bolunmusDeger.Count; i++)
                        {
                            xlWorkSheet2.Cells[i + 2, a].Value2 = bolunmusDeger[i].MusteriSoyadi;
                            xlWorkSheet2.Columns.AutoFit();

                            Excell.Borders border = xlWorkSheet2.Cells[i + 2, a].Borders;
                            BordersForArea(border);

                            tsPB.Increment(i);
                        }
                    }


                    if ((item as System.Windows.Forms.CheckBox).Name == "chck_Telefon" && (item as System.Windows.Forms.CheckBox).Checked == true)
                    {
                        a++;
                        for (int i = 0; i < bolunmusDeger.Count; i++)
                        {
                            xlWorkSheet2.Cells[i + 2, a].Value2 = bolunmusDeger[i].Telefon;
                            xlWorkSheet2.Columns.AutoFit();

                            Excell.Borders border = xlWorkSheet2.Cells[i + 2, a].Borders;
                            BordersForArea(border);

                            tsPB.Increment(i);
                        }
                    }


                    if ((item as System.Windows.Forms.CheckBox).Name == "chck_Ürünler" && (item as System.Windows.Forms.CheckBox).Checked == true)
                    {
                        a++;
                        for (int i = 0; i < bolunmusDeger.Count; i++)
                        {
                            xlWorkSheet2.Cells[i + 2, a].Value2 = bolunmusDeger[i].Urunler;
                            xlWorkSheet2.Columns.AutoFit();

                            Excell.Borders border = xlWorkSheet2.Cells[i + 2, a].Borders;
                            BordersForArea(border);

                            tsPB.Increment(i);
                        }
                    }


                    if ((item as System.Windows.Forms.CheckBox).Name == "chck_Tutar" && (item as System.Windows.Forms.CheckBox).Checked == true)
                    {
                        a++;
                        for (int i = 0; i < bolunmusDeger.Count; i++)
                        {
                            xlWorkSheet2.Cells[i + 2, a].Value2 = bolunmusDeger[i].Tutar;
                            xlWorkSheet2.Columns.AutoFit();

                            Excell.Borders border = xlWorkSheet2.Cells[i + 2, a].Borders;
                            BordersForArea(border);

                            tsPB.Increment(i);
                        }
                    }


                    if ((item as System.Windows.Forms.CheckBox).Name == "chck_Kanal" && (item as System.Windows.Forms.CheckBox).Checked == true)
                    {
                        a++;
                        for (int i = 0; i < bolunmusDeger.Count; i++)
                        {
                            xlWorkSheet2.Cells[i + 2, a].Value2 = bolunmusDeger[i].Kanal;
                            xlWorkSheet2.Columns.AutoFit();

                            Excell.Borders border = xlWorkSheet2.Cells[i + 2, a].Borders;
                            BordersForArea(border);

                            tsPB.Increment(i);
                        }
                    }


                    if ((item as System.Windows.Forms.CheckBox).Name == "chck_Kurye" && (item as System.Windows.Forms.CheckBox).Checked == true)
                    {
                        a++;
                        for (int i = 0; i < bolunmusDeger.Count; i++)
                        {
                            xlWorkSheet2.Cells[i + 2, a].Value2 = bolunmusDeger[i].Kurye;
                            xlWorkSheet2.Columns.AutoFit();

                            Excell.Borders border = xlWorkSheet2.Cells[i + 2, a].Borders;
                            BordersForArea(border);

                            tsPB.Increment(i);
                        }
                    }


                    if ((item as System.Windows.Forms.CheckBox).Name == "chck_Ödeme" && (item as System.Windows.Forms.CheckBox).Checked == true)
                    {
                        a++;
                        for (int i = 0; i < bolunmusDeger.Count; i++)
                        {
                            xlWorkSheet2.Cells[i + 2, a].Value2 = bolunmusDeger[i].Odeme;
                            xlWorkSheet2.Columns.AutoFit();

                            Excell.Borders border = xlWorkSheet2.Cells[i + 2, a].Borders;
                            BordersForArea(border);

                            tsPB.Increment(i);
                        }
                    }


                    if ((item as System.Windows.Forms.CheckBox).Name == "chck_Durum" && (item as System.Windows.Forms.CheckBox).Checked == true)
                    {
                        a++;
                        for (int i = 0; i < bolunmusDeger.Count; i++)
                        {
                            xlWorkSheet2.Cells[i + 2, a].Value2 = bolunmusDeger[i].Durum;
                            xlWorkSheet2.Columns.AutoFit();

                            Excell.Borders border = xlWorkSheet2.Cells[i + 2, a].Borders;
                            BordersForArea(border);

                            tsPB.Increment(i);
                        }
                    }


                    if ((item as System.Windows.Forms.CheckBox).Name == "chck_Not" && (item as System.Windows.Forms.CheckBox).Checked == true)
                    {
                        a++;
                        for (int i = 0; i < bolunmusDeger.Count; i++)
                        {
                            xlWorkSheet2.Cells[i + 2, a].Value2 = bolunmusDeger[i].Notlar;
                            xlWorkSheet2.Columns.AutoFit();

                            Excell.Borders border = xlWorkSheet2.Cells[i + 2, a].Borders;
                            BordersForArea(border);

                            tsPB.Increment(i);
                        }
                    }
                }
            }
            
            break;

        case false:

            foreach (Control item in this.Controls)
            {
                if (item.GetType() == typeof(System.Windows.Forms.CheckBox))
                {
                    if ((item as System.Windows.Forms.CheckBox).Name == "chck_Sipariş Saati" && (item as System.Windows.Forms.CheckBox).Checked == true)
                    {
                        a++;
                        for (int i = 0; i < bolunmusDeger.Count; i++)
                        {
                            xlWorkSheet2.Cells[i + 2, a].Value2 = bolunmusDeger[i].SiparisSaati;
                            xlWorkSheet2.Columns.AutoFit();

                            Excell.Borders border = xlWorkSheet2.Cells[i + 2, a].Borders;
                            BordersForArea(border);

                            tsPB.Increment(i);
                        }
                    }


                    if ((item as System.Windows.Forms.CheckBox).Name == "chck_Müşteri Adı" && (item as System.Windows.Forms.CheckBox).Checked == true)
                    {
                        a++;
                        for (int i = 0; i < bolunmusDeger.Count; i++)
                        {
                            xlWorkSheet2.Cells[i + 2, a].Value2 = bolunmusDeger[i].MusteriAdi;
                            xlWorkSheet2.Columns.AutoFit();

                            Excell.Borders border = xlWorkSheet2.Cells[i + 2, a].Borders;
                            BordersForArea(border);

                            tsPB.Increment(i);
                        }
                    }


                    if ((item as System.Windows.Forms.CheckBox).Name == "chck_Müşteri Soyadı" && (item as System.Windows.Forms.CheckBox).Checked == true)
                    {
                        a++;
                        for (int i = 0; i < bolunmusDeger.Count; i++)
                        {
                            xlWorkSheet2.Cells[i + 2, a].Value2 = bolunmusDeger[i].MusteriSoyadi;
                            xlWorkSheet2.Columns.AutoFit();

                            Excell.Borders border = xlWorkSheet2.Cells[i + 2, a].Borders;
                            BordersForArea(border);

                            tsPB.Increment(i);
                        }
                    }


                    if ((item as System.Windows.Forms.CheckBox).Name == "chck_Telefon" && (item as System.Windows.Forms.CheckBox).Checked == true)
                    {
                        a++;
                        for (int i = 0; i < bolunmusDeger.Count; i++)
                        {
                            xlWorkSheet2.Cells[i + 2, a].Value2 = bolunmusDeger[i].Telefon;
                            xlWorkSheet2.Columns.AutoFit();

                            Excell.Borders border = xlWorkSheet2.Cells[i + 2, a].Borders;
                            BordersForArea(border);

                            tsPB.Increment(i);
                        }
                    }


                    if ((item as System.Windows.Forms.CheckBox).Name == "chck_Ürünler" && (item as System.Windows.Forms.CheckBox).Checked == true)
                    {
                        a++;
                        for (int i = 0; i < bolunmusDeger.Count; i++)
                        {
                            xlWorkSheet2.Cells[i + 2, a].Value2 = bolunmusDeger[i].Urunler;
                            xlWorkSheet2.Columns.AutoFit();

                            Excell.Borders border = xlWorkSheet2.Cells[i + 2, a].Borders;
                            BordersForArea(border);

                            tsPB.Increment(i);
                        }
                    }


                    if ((item as System.Windows.Forms.CheckBox).Name == "chck_Tutar" && (item as System.Windows.Forms.CheckBox).Checked == true)
                    {
                        a++;
                        for (int i = 0; i < bolunmusDeger.Count; i++)
                        {
                            xlWorkSheet2.Cells[i + 2, a].Value2 = bolunmusDeger[i].Tutar;
                            xlWorkSheet2.Columns.AutoFit();

                            Excell.Borders border = xlWorkSheet2.Cells[i + 2, a].Borders;
                            BordersForArea(border);

                            tsPB.Increment(i);
                        }
                    }


                    if ((item as System.Windows.Forms.CheckBox).Name == "chck_Kanal" && (item as System.Windows.Forms.CheckBox).Checked == true)
                    {
                        a++;
                        for (int i = 0; i < bolunmusDeger.Count; i++)
                        {
                            xlWorkSheet2.Cells[i + 2, a].Value2 = bolunmusDeger[i].Kanal;
                            xlWorkSheet2.Columns.AutoFit();

                            Excell.Borders border = xlWorkSheet2.Cells[i + 2, a].Borders;
                            BordersForArea(border);

                            tsPB.Increment(i);
                        }
                    }


                    if ((item as System.Windows.Forms.CheckBox).Name == "chck_Kurye" && (item as System.Windows.Forms.CheckBox).Checked == true)
                    {
                        a++;
                        for (int i = 0; i < bolunmusDeger.Count; i++)
                        {
                            xlWorkSheet2.Cells[i + 2, a].Value2 = bolunmusDeger[i].Kurye;
                            xlWorkSheet2.Columns.AutoFit();

                            Excell.Borders border = xlWorkSheet2.Cells[i + 2, a].Borders;
                            BordersForArea(border);

                            tsPB.Increment(i);
                        }
                    }


                    if ((item as System.Windows.Forms.CheckBox).Name == "chck_Ödeme" && (item as System.Windows.Forms.CheckBox).Checked == true)
                    {
                        a++;
                        for (int i = 0; i < bolunmusDeger.Count; i++)
                        {
                            xlWorkSheet2.Cells[i + 2, a].Value2 = bolunmusDeger[i].Odeme;
                            xlWorkSheet2.Columns.AutoFit();

                            Excell.Borders border = xlWorkSheet2.Cells[i + 2, a].Borders;
                            BordersForArea(border);

                            tsPB.Increment(i);
                        }
                    }


                    if ((item as System.Windows.Forms.CheckBox).Name == "chck_Durum" && (item as System.Windows.Forms.CheckBox).Checked == true)
                    {
                        a++;
                        for (int i = 0; i < bolunmusDeger.Count; i++)
                        {
                            xlWorkSheet2.Cells[i + 2, a].Value2 = bolunmusDeger[i].Durum;
                            xlWorkSheet2.Columns.AutoFit();

                            Excell.Borders border = xlWorkSheet2.Cells[i + 2, a].Borders;
                            BordersForArea(border);

                            tsPB.Increment(i);
                        }
                    }


                    if ((item as System.Windows.Forms.CheckBox).Name == "chck_Not" && (item as System.Windows.Forms.CheckBox).Checked == true)
                    {
                        a++;
                        for (int i = 0; i < bolunmusDeger.Count; i++)
                        {
                            xlWorkSheet2.Cells[i + 2, a].Value2 = bolunmusDeger[i].Notlar;
                            xlWorkSheet2.Columns.AutoFit();

                            Excell.Borders border = xlWorkSheet2.Cells[i + 2, a].Borders;
                            BordersForArea(border);

                            tsPB.Increment(i);
                        }
                    }
                }
            }                    
            break;
    }

    xlWorkBook2.SaveAs(klasorAdi + "\\" + "Olusturulan_" + DateTime.Now.Date.ToString("dd.MM.yyyy") + ".xlsx");
    xlWorkBook2.Close();
    xlApp.Quit();
    tsPB.Value = 0;
    MessageBox.Show("İşlem Tamamlandı", "Çalıkuşu Atakum", MessageBoxButtons.OK, MessageBoxIcon.Information);
}
